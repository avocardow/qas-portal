# Task ID: 18
# Title: Implement Graph OData searchMessages Helper in EmailService
# Status: pending
# Dependencies: None
# Priority: medium
# Description: Create a helper method in EmailService that utilizes Microsoft Graph API's OData query capabilities to search for email messages based on various criteria.
# Details:
Implement a new helper method called `searchMessages` in the EmailService class that will leverage Microsoft Graph API's OData query functionality. This method should:

1. Accept parameters for search criteria such as:
   - keywords/search text
   - date range (from/to)
   - sender email
   - folder ID (optional)
   - pagination parameters (skip/top)

2. Construct the appropriate OData query string using the provided parameters

3. Make the API call to Microsoft Graph endpoint using the existing authentication mechanism

4. Parse and transform the response into a consistent format that matches our application's data models

5. Handle error cases appropriately, including authentication errors, rate limiting, and malformed responses

6. Implement caching where appropriate to improve performance

The implementation should follow our existing patterns for Graph API integration and ensure proper error handling and logging. Documentation should be added explaining the parameters and return format.

# Test Strategy:
Testing should include:

1. Unit tests:
   - Verify correct OData query construction for different parameter combinations
   - Test error handling for various error scenarios (401, 429, etc.)
   - Validate response parsing logic with mock data

2. Integration tests:
   - Test actual API calls with test account credentials
   - Verify pagination works correctly with large result sets
   - Test search with various criteria combinations

3. Performance tests:
   - Measure response times for typical queries
   - Verify caching behavior improves performance for repeated queries

4. Manual testing:
   - Verify the helper can be used in the email filtering system (Task #17)
   - Test with real-world search scenarios to ensure results match expectations
   - Verify correct handling of special characters in search terms

# Subtasks:
## 1. Implement searchMessages in EmailService [pending]
### Dependencies: None
### Description: Add a server-side helper method in EmailService to search messages using OData , , ,  parameters
### Details:


## 2. Update EmailFilteringService to use searchMessages [pending]
### Dependencies: None
### Description: Modify getFilteredMessages to call searchMessages instead of listMessages and handle pagination from Graph nextLink
### Details:


## 3. Update EmailFilteringService tests to mock searchMessages [pending]
### Dependencies: None
### Description: Modify existing tests to stub searchMessages instead of listMessages and validate pagination behavior
### Details:


