# Task ID: 10
# Title: Implement SharePoint Folder Browser
# Status: done
# Dependencies: 2
# Priority: medium
# Description: Embed file-manager tree for client's SharePoint folders and recent invoices card on the Client Profile page.
# Details:
Embed the AllFolders and RecentFileTable components from File-Manager to create a SharePoint folder browser. Implement the Recent Invoices Card listing the last 5 invoice documents with status (paid/unpaid) and links to PDFs. Ensure proper loading states and error handling for file access.

# Test Strategy:
Test folder browser navigation. Verify file links open correctly. Test with various folder structures and file types. Check invoice status display accuracy.

# Subtasks:
## 1. Implement SharePoint Folder Browser Component [done]
### Dependencies: None
### Description: Integrate the AllFolders component from File-Manager to create a navigable SharePoint folder structure with proper folder creation and navigation capabilities.
### Details:
Begin by embedding the AllFolders component from the existing File-Manager into the application. Configure the component to connect to the client's SharePoint document library using the SharePoint API. Implement folder navigation functionality that allows users to browse through the folder hierarchy, open folders, and navigate back up using breadcrumb navigation. Add support for viewing folder contents and implement proper loading states while folder data is being fetched. Include error handling for cases where SharePoint access fails or folders cannot be loaded. Test the component with various folder structures to ensure proper rendering and navigation.

## 2. Integrate Recent Files Table Component [done]
### Dependencies: 10.1
### Description: Embed the RecentFileTable component from File-Manager to display SharePoint files with sorting and filtering capabilities.
### Details:
After the folder browser is working, integrate the RecentFileTable component from File-Manager to display files within the selected SharePoint folders. Configure the component to show file metadata including name, type, modified date, and size. Implement file opening functionality that launches files in appropriate viewers based on file type. Add loading indicators for when file lists are being retrieved. Implement error handling for file access issues, showing appropriate error messages when files cannot be accessed or displayed. Ensure the file table updates properly when users navigate between different folders in the folder browser component.

## 3. Create Recent Invoices Card Component [done]
### Dependencies: 10.2
### Description: Develop a specialized card component that displays the 5 most recent invoice documents with their payment status and PDF links.
### Details:
Build a new Recent Invoices Card component that queries SharePoint for the most recent invoice documents. Implement filtering logic to identify invoice documents based on file naming conventions or metadata. Display the 5 most recent invoices in a card format, showing for each invoice: document name, creation/modification date, payment status (paid/unpaid), and a direct link to open the PDF. The payment status should be determined by querying metadata or a related data source that tracks invoice payment information. Add visual indicators (like color coding) to distinguish between paid and unpaid invoices. Implement proper loading states while invoice data is being fetched and error handling for cases where invoice documents cannot be accessed. Ensure the component refreshes automatically when new invoices are added to SharePoint.

